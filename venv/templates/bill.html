{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <div class="card shadow-lg p-4">
        <!-- Invoice Header -->
        <h2 class="text-center mb-4">Invoice #{{ bill.Billing_ID }}</h2>

        <div class="row">
            <!-- Company Info -->
            <div class="col-md-6">
                <h5><strong>Company Information</strong></h5>
                <p><strong>{{ company.name }}</strong></p>
                <p>{{ company.address }}</p>
                <p>Email: {{ company.email }}</p>
                <p>Phone: {{ company.phone }}</p>
            </div>

            <!-- Client Info -->
            <div class="col-md-6 text-md-end">
                <h5><strong>Client Information</strong></h5>
                <p><strong>{{ client.first_name }} {{ client.last_name }}</strong></p>
                <p>{{ client.address }}</p>
                <p>{{ client.city }}, {{ client.province }} {{ client.postal_code }}</p>
                <p>{{ client.country }}</p>
                <p>Email: {{ client.email }}</p>
                <p>Phone: {{ client.phone_number }}</p>
            </div>
        </div>

        <!-- Date -->
        <hr>
        <p><strong>Date:</strong> {{ bill.Date.strftime('%Y-%m-%d') }}</p>

        <!-- Products Purchased -->
        <h5 class="mt-4"><strong>Products Purchased</strong></h5>
        <table class="table table-bordered text-center">
            <thead class="table-dark">
                <tr>
                    <th>Product Name</th>
                    <th>Unit Price</th>
                    <th>Quantity</th>
                    <th>Subtotal</th>
                </tr>
            </thead>
            <tbody>
                {% for detail in bill.details %}
                <tr>
                    <td>{{ detail.product.name if detail.product else 'Unknown Product' }}</td>
                    <td>${{ "%.2f"|format(detail.Price) }}</td>
                    <td>{{ detail.Quantity }}</td>
                    <td>${{ "%.2f"|format(detail.Price * detail.Quantity) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- Total Calculation -->
        <div class="row mt-4">
            <div class="col-md-6"></div>  <!-- Empty Space for Alignment -->
            <div class="col-md-6">
                <table class="table text-end">
                    <tr>
                        <td><strong>Total Before Tax:</strong></td>
                        <td>${{ "%.2f"|format(bill.Total_BT) }}</td>
                    </tr>
                    <tr>
                        <td><strong>HST:</strong></td>
                        <td>${{ "%.2f"|format(bill.Total_HST) }}</td>
                    </tr>
                    <tr class="table-dark text-white">
                        <td><strong>Total Amount:</strong></td>
                        <td><strong>${{ "%.2f"|format(bill.Total_Net) }}</strong></td>
                    </tr>
                </table>
            </div>
        </div>

        <!-- Download Button -->
        <div class="text-center mt-4">
            <a href="{{ url_for('views.download_bill', bill_id=bill.Billing_ID) }}" class="btn btn-primary btn-lg">
                ðŸ“„ Download as PDF
            </a>
        </div>
    </div>
</div>

<style>
    .container {
        max-width: 90%;
    }
    .card {
        border-radius: 10px;
        padding: 20px;
        background-color: #ffffff;
    }
    .table {
        border-radius: 10px;
        overflow: hidden;
    }
    .table th, .table td {
        padding: 10px;
    }
    .table-dark {
        background-color: #333;
    }
</style>

{% endblock %}
